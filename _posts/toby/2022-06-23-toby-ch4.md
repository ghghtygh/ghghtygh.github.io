---
title : "토비의 스프링 - 4.예외"

categories:
 - Posts

tags:
 - [Spring, Book, 토비의스프링]

#toc: true
#toc_sticky: true
published: true
date: 2022-06-23
last_modified_at: 2022-06-23
---

# 4장 예외 요약

## 예외의 종류와 특징

### Error

java.lang.Error 클래스의 서브클래스

주로 JVM에서 발생한 시스템의 비정상적인 상황 발생시 사용

대응 방법이 없기에 시스템 레벨의 작업이 있지 않는 이상 애플리케이션에서는 에러처리 X

### Exception

java.lang.Exception 클래스와 그 서브클래스

애플리케이션 코드의 작업 중 발생한 예외상황에서 사용

일반적으로 체크예외를 말하며, 체크예외가 발생할 수 있는 메서드 사용시 반드시 예외 처리코드 작성 필요

체크예외 : Exception 클래스의 서브클래스이면서 RuntimeException 상속 X

언체크예외 : Exception 클래스의 서브클래스이면서 RuntimeException 상속

### RuntimeException

java.lang.RuntimeException 클래스를 상속한 예외는 명시적인 예외처리 강제 X

주로 프로그램의 오류가 있을 때 발생하도록 의도된 예외 (개발자의 부주의)

NullPointException : 오브젝트를 할당하지 않은 레퍼런스 변수를 사용하려고 시도

IllegalArgumentException : 허용되지 않는 값을 사용하여 메서드를 호출

---

## 예외처리 방법

### 예외 복구

예외상황 파악 → 문제 해결 → 정상상태

사용자 요청 파일이 없는 경우 → IOException 발생 → 사용자에게 다른 파일 이용하도록 안내 → 예외상황 해결

불안정한 네트워크로 DB 접속 실패 → SQLException 발생 → 대기 후 재시도(최대 횟수 지정) → 정상 접속
→ 예외상황 해결

### 예외처리 회피

예외 처리를 자신이 담당하지 않고 호출한 쪽으로 던지는 것 (throws 문 또는 catch 문 이후 rethrow)

JdbcContext나 jdbcTemplate에서의 콜백 오브젝트에서는 SQLException에 대한 예외를 회피하고 템플릿 레벨에서 처리하도록 던져줌

### 예외 전환

예외 복구가 불가능할 경우 예외를 메서드 밖으로 던지는 것 

예외처리 회피와는 다르게 발생한 예외를 그대로 넘기지 않고 적절한 에외로 전환해서 던짐

1. 내부에서 발생한 예외를 예외 상황에 대한 적절한 의미가 부여된 예외로 변경하기 위해 사용
: 회원가입시 아이디가 중복되어 SQLException 발생시 서비스에서 예외 복구를 위해 DAO에서 의미가 분
명한 예외로 전환
2. 예외를 처리하기 쉽고 단순하게 포장하기 위해 사용
: 주로 예외처리가 강제된 체크예외를 언체크 예외인 런타임 예외로 바꾸는 경우에 사용
비즈니스 로직에 의미가 없거나 복구가 불가능한 체크예외를 넘기는건 의미가 없기 때문에 시스템 Exception으로 인식하여 트랜잭션이 롤백되도록 런타입 예외로 포장하여 전달

---

## 예외처리 전략

### 런타임 예외의 보편화

체크 예외는 복구할 가능성이 조금이라도 있는 예외적인 상황을 말하기 때문에 catch 블록이나 throws 선언을 강제함

자바가 처음 만들어질 때 많이 사용하던 애플릿이나 AWT, Swing을 사용한 독립형 애플리케이션에서는 시스템 예외라고 해도 작업이 중단되서는 않되는 경우가 많았음

현재 자바 엔터프라이즈 서버환경에서는 수많은 사용자가 보내는 동시 요청을 독립적인 작업으로 취급하기 때문에 예외 발생시 해당 작업을 중지시킴

최근 표준 스펙 또는 오픈소스 프레임워크에서는 API가 발생시키는 예외를 체크 예외 대신 언체크 예외로 정의하는 것이 일반화되고 있으며 언체크 에외라도 필요하다면 catch 블록을 통해 복구하거나 처리할 수 있으므로 아예 API 차원에서 런타임 예외를 던지도록 만드는 경향이 있다.

### 애플리케이션 예외

애플리케이션 자체 로직에 의해 의도적으로 발생시키거나 반드시 catch하여 조치를 취하도록 해야하는 예외를 말함

은행계좌에서 출금하는 기능의 경우, 출금 전 현재 잔고를 확인하고 허용된 범위 이상의 출금 요청일 경우 출금 작업을 중단시키고 경고 메세지를 출력

1. 정상적인 출금처리와 예외 상황에서의 리턴 값을 다르게 함
: 정상적인 출금 요청 - 요청금액 자체 리턴
  비정상적인 출금 요청 - 0 또는 -1 리턴
2. 잔고 부족 등의 예외 상황에서 비즈니스적인 의미의 예외를 던짐
: 의도적으로 체크 예외를 만들어 잔고 부족인 경우 InsufficientBalanceException 등을 던지게 함